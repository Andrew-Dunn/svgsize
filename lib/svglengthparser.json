{
    "lex": {
        "rules": [
           ["[+-]", "return 'SIGN';"],
           ["[0-9]", "return 'DIGIT';"],
           ["\\.", "return '.';"],
           ["(em|ex|px|in|cm|mm|pt|pc|%)", "return 'UNIT';"],
           ["[Ee]", "return 'EXP';"]
        ]
    },

    "bnf": {
        "length": [["number UNIT", "return {value: $1, units: $2};"],
                   ["number", "return {value: $1, units: ''};"]],
        "number": [["sign posnumber", "$$ = $1 * $2;"],
                   "posnumber"],
        "posnumber": [["plainnumber exponent", "$$ = $1 * Math.pow(10, $2);"],
                      "plainnumber"],
        "plainnumber": ["digits", "float"],
        "float": [["digits fractional", "$$ = $1 + $2;"],
                  "fractional"],
        "fractional": [[". digits", "$$ = +`0.${$2}`;"]],
        "exponent": [["EXP sign digits", "$$ = $2 * $3;"],
                     ["EXP digits", "$$ = $2"]],
        "sign": [["SIGN", "$$ = ($1 == '+' ? 1 : -1)"]],
        "digits": [["digits DIGIT", "$$ = $1*10 + (+$2);"],
                   ["DIGIT", "$$ = +$1;"]]
    }
}
